<h2 id="behaviour-instances">Behaviour instances</h2>
<p>A service participates in a session by executing an instance of its behaviour. So far we have executed behaviours a single time, which means that each service we run supported only a single session. If needed again, the service must be executed manually another time.</p>
<p>Jolie allows to reuse behavioural definition multiple times with the <em>execution modality</em> deployment primitive, whose syntax is:</p>
<div class="syntax" src="syntax_processes_1.ol"></div>

<p><code>single</code> is the default execution modality (so the <code>execution</code> construct can be omitted), which runs the program behaviour once. <code>sequential</code>, instead, causes the program behaviour to be made available again after the current instance has terminated. This is useful, for instance, for modelling services that need to guarantee exclusive access to a resource. Finally, <code>concurrent</code> causes a program behaviour to be instantiated and executed <em>whenever its first input statement can receive a message</em>.</p>
<div class="attention"><p>
In the <code>sequential</code> and <code>concurrent</code> cases, the behavioural definition inside the main procedure must be an input statement.
</p></div>

<p>A crucial aspect of behaviour instances is that each instance has its own private state, determining variable scoping. This lifts programmers from worrying about race conditions in most cases.</p>
<p>For instance, let us recall the server program given at the end of <a href="basics/communication_ports">Communication Ports</a> section. We can simply add the deployment instruction <code>execution{ concurrent }</code> to the server's deployment to make it supporting multiple clients at the same time. Access to variables would be safe since each behaviour instance would have its private state.</p>
<div class="code" src="processes_1.ol"></div>

<hr />
<h2 id="init"><code>init{}</code></h2>
<p>Jolie also supports special procedures for initialising a service before it makes its behaviours available. The <code>init{}</code> scope allows the specification of such procedures. All the code specified within the <code>init{}</code> scope is executed only once, when the service is started.</p>
<hr />
<h2 id="global-variables">Global variables</h2>
<p>Jolie also provides <em>global variables</em> to support sharing of data among different behaviour instances. These can be accessed using the <code>global</code> prefix:</p>
<div class="code" src="processes_3.ol"></div>

<hr />
<h2 id="synchronisation">Synchronisation</h2>
<p>Concurrent access to global variables can be restricted through <code>synchronized</code> blocks, similarly to Java:</p>
<div class="syntax" src="syntax_processes_2.ol"></div>

<p>The synchronisation block allows only one process at a time to enter any <code>synchronized</code> block sharing the same <code>id</code>.</p>
<hr />
<h2 id="a-comprehensive-example">A comprehensive example</h2>
<p>Let us consider a comprehensive example using the concepts explained in this section.</p>
<p>The register service has a concurrent execution and exposes the <code>register</code> request-response operation. <code>register</code> increments a global variable, which counts the number of registered users, and sends back a response to the client.</p>
<p><em>regInterface.ol</em></p>
<div class="code" src="processes_4.ol"></div>

<p><em>server.ol</em></p>
<div class="code" src="processes_2.ol"></div>

<p><em>client.ol</em></p>
<div class="code" src="processes_5.ol"></div>

<p>The programs can be downloaded from the link below:</p>
<div class="download">
<a href="documentation/basics/code/processes_code.zip">Processes Code Example</a>
</div>

<p>Once extracted, the two programs may be run in two separate shells. Make sure to start <code>register.ol</code> before <code>client.ol</code>. Try to start more than one <code>client.ol</code> at once and see the results.</p>
